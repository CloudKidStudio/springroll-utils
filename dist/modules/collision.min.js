/*! springroll-utils 0.0.1 */
!function(){"use strict";!function(){var a=include("PIXI.Point",!1)||include("createjs.Point",!1),b=include("PIXI.Rectangle",!1)||include("createjs.Rectangle",!1);if(!a||!b)throw"collision.Polygon requires Point and Rectangle from either PIXI or createjs!";b.prototype.intersects||(b.prototype.intersects=function(a){return a.x<=this.x+this.width&&this.x<=a.x+a.width&&a.y<=this.y+this.height&&this.y<=a.y+a.height});var c=function(c,d,e){this.isRectangle=!!e,this._curRotation=0,this.aabb=new b,this.aabbIsDirty=!0,this.origin=new a(0,0),this._scale=1,this.points=[],this.edges=[];for(var f,g=null,h=0,i=c.length;i>h;++h)f=c[h],g&&this.edges.push(new a(f.x-g.x,f.y-g.y)),this.points.push(new a(f.x,f.y)),g=f;f=c[0],this.edges.push(new a(f.x-g.x,f.y-g.y)),d&&"number"==typeof d&&(this.scale=d)},d=c.prototype={};Object.defineProperty(d,"scale",{get:function(){return this._scale},set:function(a){if(a!=this._scale&&a==a){var b=a/this._scale;this._scale=a;var c,d,e,f,g,h=this.points,i=this.edges;for(c=0,d=h.length;d>c;++c){e=h[c];var j=e.x*b,k=e.y*b;e.x=j,e.y=k,f&&(g=i[c-1],g.x=j-f.x,g.y=k-f.y),f=e}e=h[0],g=i[c-1],g.x=e.x-f.x,g.y=e.y-f.y,this.aabbIsDirty=!0}}});var e=Math.PI/180;Object.defineProperty(d,"rotation",{get:function(){return this._curRotation},set:function(a){if(a!=this._curRotation&&a==a){var b,c,d,f,g,h=this.points,i=this.edges,j=(newRotation-this._curRotation)*e;this._curRotation=newRotation;var k=Math.sin(j),l=Math.cos(j);for(b=0,c=h.length;c>b;++b){d=h[b];var m=d.x*l-d.y*k,n=d.x*k+d.y*l;d.x=m,d.y=n,f&&(g=i[b-1],g.x=m-f.x,g.y=n-f.y),f=d}d=h[0],g=i[b-1],g.x=d.x-f.x,g.y=d.y-f.y,this.aabbIsDirty=!0}}}),d.calcAABB=function(){var a,b,c,d=this.aabb,e=this.points,f=this.origin,g=1/0,h=-(1/0),i=1/0,j=-(1/0);for(b=0,c=e.length;c>b;++b){a=e[b];var k=a.x,l=a.y;g>k&&(g=k),k>h&&(h=k),i>l&&(i=l),l>j&&(j=l)}d.x=g+f.x,d.y=i+f.y,d.width=h-g,d.height=j-i},d.updateOrigin=function(a,b){this.origin.x=a,this.origin.y=b,this.aabbIsDirty=!0},d.resetPositioning=function(){this.origin.x=this.origin.y=0,this.rotation=0,this.aabbIsDirty=!0},d.contains=function(a,b,c){var d=!1;c||(a-=this.origin.x,b-=this.origin.y);for(var e,f,g,h,i,j,k,l=this.points,m=0,n=l.length,o=l.length-1;n>m;o=m++)e=l[m],f=l[o],g=e.x,h=e.y,i=f.x,j=f.y,k=h>b!=j>b&&(i-g)*(b-h)/(j-h)+g>a,k&&(d=!d);return d},d.toString=function(){return"[collision.Polygon - points: "+this.points.join(",")+"]"},d.destroy=function(){this.origin=this.edges=this.points=null},c.fromCircle=function(a,b){b>=4||(b=4);for(var d=a.x,e=a.y,f=a.radius||a.r||1,g=2*Math.PI/b,h=[],i=0;b>i;++i)h.push({x:d+Math.cos(g*i)*f,y:e+Math.sin(g*i)*f});return new c(h,1,4==b)},c.fromEllipse=function(a,b){b>=4||(b=6);for(var d=a.x,e=a.y,f=(a.width||a.w)/2,g=(a.height||a.h)/2,h=2*Math.PI/b,i=[],j=0;b>j;++j)i.push({x:d+Math.cos(h*j)*f,y:e+Math.sin(h*j)*g});return new c(i,1,4==b)},c.fromRect=function(a){var b=a.x,d=a.y,e=a.width||a.w,f=a.height||a.h,g=[{x:b,y:d},{x:b+e,y:d},{x:b+e,y:d+f},{x:b,y:d+f}];return new c(g,1,!0)},namespace("collision").Polygon=c}(),function(){var a=include("PIXI.Point",!1)||include("createjs.Point",!1),b={},c=new a(0,0),d={min:0,max:0},e={min:0,max:0};b.checkPolygonCollision=function(a,b){if(a.aabbIsDirty&&a.calcAABB(),b.aabbIsDirty&&b.calcAABB(),!a.aabb.intersects(b.aabb))return!1;var g=a.edges,h=g.length;a.isRectangle&&(h/=2);var i=b.edges,j=i.length;b.isRectangle&&(j/=2);var k,l=c;d.min=0,d.max=0,e.min=0,e.max=0;for(var m=0,n=h+j;n>m;m++){k=h>m?g[m]:i[m-h],l.x=-k.y,l.y=k.x,l.normalize(),f(l,a,d),f(l,b,e);var o=d.min,p=d.max,q=e.min,r=e.max,s=q>o?q-p:o-r;if(s>0)return!1}return!0};var f=function(a,b,c){for(var d=b.points,e=b.origin.x,f=b.origin.y,h=a.x,i=a.y,j=d[0],k=g(j.x+e,j.y+f,h,i),l=k,m=k,n=1,o=d.length;o>n;n++)j=d[n],k=g(j.x+e,j.y+f,h,i),l>k?l=k:k>m&&(m=k);c.min=l,c.max=m},g=function(a,b,c,d){return a*c+b*d};b.getLineIntersection=function(a,b,c,d,e,f,g,h,i){var j,k,l,m;j=c-a,k=d-b,l=g-e,m=h-f;var n,o,p=1/(-l*k+j*m);return n=(-k*(a-e)+j*(b-f))*p,o=(l*(b-f)-m*(a-e))*p,n>=0&&1>=n&&o>=0&&1>=o?(i&&(i.x=a+o*j,i.y=b+o*k),!0):!1},b.getLinePolygonCollision=function(a,c,d,e,f,g){f.aabbIsDirty&&f.calcAABB();for(var h=f.points,i=f.origin.x,j=f.origin.y,k=h[0],l=h.length-1;l>=0;--l){var m=h[l];if(b.getLineIntersection(a,c,d,e,i+m.x,j+m.y,i+k.x,j+k.y,g))return!0;k=m}return!1},namespace("collision").CollisionUtils=b}();}();